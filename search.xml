<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>wsl2突然无法ping通宿主机的问题处理</title>
      <link href="/2024/06/06/wsl2-ping-unreachable/"/>
      <url>/2024/06/06/wsl2-ping-unreachable/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>windows下的docker用得好好的，但突然有一天docker容器无法访问宿主机中的代理，进入容器发现无法ping通宿主机。（我只是个小呆瓜，我也很懵啊）<br><img src="https://github.com/Samge0/samge-blog/assets/17336101/293ab6c5-d899-4581-97ee-e321e9572395" alt="image"></p><p>经过重重排查，发现是wsl2中的网络配置问题，这里简单记录一下。</p><h2 id="处理过程"><a href="#处理过程" class="headerlink" title="处理过程&gt;&gt;&gt;"></a>处理过程&gt;&gt;&gt;</h2><h3 id="1、检查网络配置"><a href="#1、检查网络配置" class="headerlink" title="1、检查网络配置"></a>1、检查网络配置</h3><p>查看wsl2网络配置跟宿主机网络配置是否一致</p><p>分别在wsl2虚拟机中执行<code>ifconfig</code>跟在windows中执行<code>ipconfig /all</code>，发现wsl2中的ip为<code>172.24.101.x</code>，windows中的WSL桥适配器的ip是<code>172.24.96.x</code>，需要将wsl2中的ip改成windows中WSL桥适配器同一网段的ip。<br><img src="https://github.com/Samge0/samge-blog/assets/17336101/4d27e4e2-b438-4bba-85e7-94adc2d890db" alt="image"></p><h3 id="2、修改配置"><a href="#2、修改配置" class="headerlink" title="2、修改配置"></a>2、修改配置</h3><p>修改wsl2中的ip（例如这里修改为<code>172.24.96.100</code>）</p><ul><li>【可选】在wsl2终端中临时修改，用于测试是否可行：  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo ifconfig eth0 172.24.96.100 netmask 255.255.240.0</span><br><span class="line">sudo route add default gw 172.24.96.1 eth0</span><br></pre></td></tr></table></figure></li><li>【推荐】修改wsl2虚拟机中的配置文件<code>/etc/netplan/01-netcfg.yaml</code>  <figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF | tee /etc/netplan/01-netcfg.yaml</span><br><span class="line">network:</span><br><span class="line">version: 2</span><br><span class="line">ethernets:</span><br><span class="line">    eth0:</span><br><span class="line">    dhcp4: no</span><br><span class="line">    addresses: [172.24.96.100/20]</span><br><span class="line">    gateway4: 172.24.96.1</span><br><span class="line">    nameservers:</span><br><span class="line">        addresses: [8.8.8.8]</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>  然后执行 <code>sudo netplan apply</code> 使配置生效</li></ul><h3 id="3、验证结果"><a href="#3、验证结果" class="headerlink" title="3、验证结果"></a>3、验证结果</h3><p>修改wsl2的ip配置后，可以正常ping通宿主机了。<br><img src="https://github.com/Samge0/samge-blog/assets/17336101/c318db43-5f42-4430-a1a9-9f0632540f6c" alt="image"></p><h2 id="其他说明"><a href="#其他说明" class="headerlink" title="其他说明&gt;&gt;&gt;"></a>其他说明&gt;&gt;&gt;</h2><h3 id="1、参考文章"><a href="#1、参考文章" class="headerlink" title="1、参考文章"></a>1、参考文章</h3><ul><li><a href="https://www.jianshu.com/p/ba2cf239ebe0">WSL2 网络异常排查 [ping 不通、网络地址异常、缺少默认路由、被宿主机防火墙拦截]</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> wls2 </tag>
            
            <tag> docker </tag>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2024/05/27/hello-world/"/>
      <url>/2024/05/27/hello-world/</url>
      
        <content type="html"><![CDATA[<h2 id="Hi-guys"><a href="#Hi-guys" class="headerlink" title="Hi guys"></a>Hi guys</h2><p>my name is samge, nice to meet you.</p>]]></content>
      
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
